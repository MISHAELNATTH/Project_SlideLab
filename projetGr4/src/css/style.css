:root{
  --bg:#0b1220;
  --panel:#0f1b2e;
  --panel2:#0c1626;
  --border:rgba(255,255,255,.10);
  --text:rgba(255,255,255,.92);
  --muted:rgba(255,255,255,.65);
  --accent:#7c5cff;
  --shadow:0 20px 60px rgba(0,0,0,.45);
  --radius:16px;

  --bottom-h: 170px;
  --sidebar-w: 320px;

  /* Toolbar sizing (fix proportions & vertical centering) */
  --tb-h: 44px;
  --tb-item-h: 32px;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
  background:
    radial-gradient(1200px 800px at 30% 10%, rgba(124,92,255,.25), transparent 55%),
    radial-gradient(900px 600px at 80% 20%, rgba(0,225,255,.12), transparent 60%),
    var(--bg);
  color:var(--text);
  height:100vh;
  overflow:hidden;
}

/* =========================
   LAYOUT GLOBAL
========================== */
.app{
  display:grid;
  grid-template-columns: var(--sidebar-w) 1fr;
  grid-template-rows: 1fr auto var(--bottom-h);
  height:100vh;
  gap:0 14px;
  padding:14px;
}

/* =========================
   SIDEBAR (LEFT)
========================== */
.sidebar{
  grid-column:1;
  grid-row:1 / span 3;
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border:1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow:hidden;
  display:flex;
  flex-direction:column;
  min-width:155px;
}

.sidebar .top{
  padding:14px 14px 10px;
  border-bottom:1px solid var(--border);
  background: rgba(0,0,0,.08);
}

.brand{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}
.brand h1{
  margin:0;
  font-size:14px;
  font-weight:700;
  letter-spacing:.4px;
  color:var(--text);
}
.pill{
  font-size:12px;
  color:var(--muted);
  border:1px solid var(--border);
  padding:6px 10px;
  border-radius:999px;
  background: rgba(0,0,0,.12);
}

.search{
  margin-top:10px;
  display:flex;
  gap:8px;
  align-items:center;
}
.search input{
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--border);
  background: rgba(0,0,0,.18);
  color:var(--text);
  outline:none;
}
.search input::placeholder{color:rgba(255,255,255,.45)}

.tool-groups{
  padding:12px;
  overflow:auto;
}
.tool-groups::-webkit-scrollbar { display:none; }

.group{ margin-bottom:14px; }
.group-title{
  font-size:12px;
  text-transform:uppercase;
  letter-spacing:.12em;
  color:rgba(255,255,255,.55);
  margin:8px 4px;
}

.tool{
  width:100%;
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 10px;
  border-radius:14px;
  border:1px solid var(--border);
  background: rgba(0,0,0,.16);
  cursor:grab;
  user-select:none;
  margin-bottom:10px;
  transition: transform .08s ease, background .12s ease, border-color .12s ease;
}
.tool:active{cursor:grabbing}
.tool:hover{
  transform: translateY(-1px);
  background: rgba(124,92,255,.14);
  border-color: rgba(124,92,255,.45);
}
.icon{
  width:34px;height:34px;
  border-radius:12px;
  display:grid;
  place-items:center;
  background: rgba(255,255,255,.07);
  border:1px solid var(--border);
  flex:0 0 auto;
  font-size:16px;
}
.tool .meta{ display:flex; flex-direction:column; gap:2px; align-items:flex-start; }
.tool .meta b{font-size:13px}
.tool .meta span{font-size:12px;color:var(--muted)}

.sidebar .bottom{
  margin-top:auto;
  padding:12px;
  border-top:1px solid var(--border);
  display:flex;
  gap:10px;
  background: rgba(0,0,0,.10);
}

/* Buttons */
.btn{
  border:1px solid var(--border);
  background: rgba(255,255,255,.06);
  color:var(--text);
  padding:10px 12px;
  border-radius:14px;
  cursor:pointer;
  font-weight:600;
  font-size:13px;
  transition: transform .12s ease, background .12s ease, border-color .12s ease;
}
.btn.primary{
  background: linear-gradient(135deg, rgba(124,92,255,.95), rgba(124,92,255,.55));
  border-color: rgba(124,92,255,.65);
}
.btn:hover{
  transform: scale(1.05);
  background: rgba(255,255,255,.12);
}

/* =========================
   MAIN (CENTER)
========================== */
.main{
  grid-column:2;
  grid-row:1;
  position:relative;
  border:1px solid var(--border);
  border-radius: var(--radius);
  background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
  box-shadow: var(--shadow);
  overflow:hidden;
  display:flex;
  flex-direction:column;
}

.topbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:10px 12px;
  border-bottom:1px solid var(--border);
  background: rgba(0,0,0,.12);
}
.topbar .left, .topbar .right, .topbar .center{
  display:flex; align-items:center; gap:10px;
}
.topbar .title{
  font-size:13px;
  color:var(--muted);
}

.chip{
  border:1px solid var(--border);
  background: rgba(0,0,0,.12);
  padding:8px 10px;
  border-radius:999px;
  font-size:12px;
  color:rgba(255,255,255,.75);
}

/* Background controls */
.background-controls{
  display:flex;
  align-items:center;
  gap:8px;
}
.background-controls .label{
  font-size:12px;
  color:var(--muted);
}
.background-controls input[type="color"]{
  width:36px;
  height:32px;
  border:1px solid var(--border);
  border-radius:8px;
  background: rgba(255,255,255,.06);
  cursor:pointer;
  padding:2px;
}

/* =========================
   RESIZERS
========================== */
.resizer-y{
  grid-column:2;
  grid-row:2;
  height:14px;
  cursor:ns-resize;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:10;
  transition: background .2s;
}
.resizer-y:hover{
  background: rgba(255,255,255,0.1);
  border-radius:4px;
}
.resizer-y::after{
  content:"";
  width:40px;
  height:3px;
  background: rgba(255,255,255,0.3);
  border-radius:2px;
}
.resizer-y.resizing::after, .resizer-y:hover::after{
  background: var(--accent);
}

.resizer-x{
  grid-column:1 / span 2;
  grid-row:1 / span 3;
  width:14px;
  cursor:ew-resize;
  display:flex;
  align-items:center;
  justify-content:flex-end;
  z-index:10;
  margin-left: calc(var(--sidebar-w) - 7px);
  transition: background .2s;
}
.resizer-x:hover{
  background: rgba(255,255,255,0.1);
  border-radius:4px;
}
.resizer-x::after{
  content:"";
  width:3px;
  height:40px;
  background: rgba(255,255,255,0.3);
  border-radius:2px;
}
.resizer-x.resizing::after, .resizer-x:hover::after{
  background: var(--accent);
}

/* =========================
   WORKSPACE / STAGE / SLIDE
========================== */
.workspace{
  flex:1;
  position:relative;
  overflow:auto;
  padding:28px 24px;
  background:
    radial-gradient(800px 500px at 40% 20%, rgba(255,255,255,.06), transparent 10%),
    rgba(0,0,0,.08);
}
.workspace::-webkit-scrollbar{ display:none; }

.stage{
  width: calc(100% - 40px);
  min-height: calc(100% - 40px);
  position:relative;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding: 20px 0 40px;
}

.slide-wrap{
  position:relative;
  transform: translateX(60px);
}

.slide{
  width: 960px;
  height: 540px;
  background: #ffffff;
  border-radius: 18px;
  box-shadow: 0 25px 70px rgba(0,0,0,.45);
  position:relative;
  overflow:hidden;
}

.slide::before{
  content:"";
  position:absolute; inset:0;
  background-image:
    linear-gradient(to right, rgba(0,0,0,.06) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(0,0,0,.06) 1px, transparent 1px);
  background-size: 40px 40px;
  opacity:.35;
  pointer-events:none;
}

.drop-hint{
  position:absolute;
  inset: 18px;
  border:2px dashed rgba(124,92,255,.45);
  border-radius: 16px;
  display:none;
  pointer-events:none;
  background: rgba(124,92,255,.06);
}
.slide.dragover .drop-hint{ display:block; }

/* =========================
   ELEMENTS SUR SLIDE
========================== */
.el{
  position:absolute;
  min-width: 120px;
  min-height: 44px;
  padding:12px 14px;
  border-radius:14px;

  /* IMPORTANT: enlever “fond blanc derrière zones de texte / images” */
  background: transparent;

  /* border subtil seulement pour que l’élément soit “prenable” */
  border:1px solid rgba(0,0,0,.10);

  cursor:move;
  user-select:none;
}
.el.selected{
  outline: 2px solid rgba(124,92,255,.85);
  outline-offset: 2px;
}

/* TEXT: plus de fond blanc */
.el.text{
  font-size:28px;
  font-weight:800;
  letter-spacing:-.02em;
  background-color: transparent;
  cursor: text;
  border-color: transparent;
}

/* BUTTON */
.el.button{
  cursor:text;
  border-radius:999px;
  background:#111827;
  color:white;
  font-weight:700;
  font-size:16px;
  padding:12px 18px;
  border:none;
  user-select:text;
}

/* TABLE */
.el.table{
  padding:0;
  overflow:hidden;
  cursor:move;
  border-radius:18px;
}
.el.table th,
.el.table td{ cursor:text; }

/* SHAPE */
.el.shape{
  position:relative;
  width:220px;
  height:120px;
  padding:0;
  border-radius:18px;
  background: transparent;
  border:none;
  pointer-events:auto;
  cursor:move;
}
.shape-content-wrapper{
  position:absolute;
  top:0; left:0;
  width:100%; height:100%;
  pointer-events:none;
  box-sizing:border-box;
}
.el.shape.rectangle .shape-content-wrapper{ border-radius:18px; }
.el.shape.circle .shape-content-wrapper{ border-radius:50%; }
.el.shape.triangle .shape-content-wrapper{
  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
  border-radius:0;
}
.el.shape.star .shape-content-wrapper{
  clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
  border-radius:0;
}
.el.shape.diamond .shape-content-wrapper{
  clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
  border-radius:0;
}

/* IMAGE: enlever fond blanc/gris derrière */
.el.image{
  width: 340px;
  height: 220px;
  padding:0;
  border:1px solid rgba(0,0,0,.12);
  background: transparent;
  display:grid;
  place-items:center;
  color:#6b7280;
  font-weight:700;
}

.el-img-wrapper{
  width:100%;
  height:100%;
  border-radius:18px;
  overflow:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
}

/* =========================
   RESIZE HANDLES
========================== */
.handle{
  position:absolute;
  width:10px;height:10px;
  background: white;
  border:2px solid rgba(124,92,255,.95);
  border-radius:999px;
  display:none;
}
.el.selected .handle{ display:block; }
.h-br{ right:-6px; bottom:-6px; cursor:nwse-resize; }
.h-tr{ right:-6px; top:-6px; cursor:nesw-resize; }
.h-bl{ left:-6px; bottom:-6px; cursor:nesw-resize; }
.h-tl{ left:-6px; top:-6px; cursor:nwse-resize; }

/* =========================
   TOOLBARS (TEXT / SHAPE / TABLE)
   Fix: toujours proportionnées + éléments centrés verticalement
========================== */
.text-toolbar,
.shape-controls,
.table-controls{
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  background: rgba(15, 27, 46, 0.95);
  border:1px solid var(--border);
  border-radius:12px;
  padding:6px 10px;

  display:none;
  align-items:center;           /* <<< centre vertical */
  height: var(--tb-h);          /* <<< fixe hauteur */
  gap:8px;
  z-index:1000;

  box-shadow: 0 8px 24px rgba(0,0,0,0.4);
  backdrop-filter: blur(10px);
}

/* positions */
.text-toolbar{ top: calc(-1 * (var(--tb-h) + 16px)); }
.table-controls{ top: calc(-1 * (var(--tb-h) + 16px)); }
.shape-controls{ top: calc(-1 * (var(--tb-h) + 26px)); }

/* show only when selected */
.el.text.selected .text-toolbar,
.el.button.selected .text-toolbar{ display:flex; }

.el.shape.selected .shape-controls{ display:flex; }
.el.table.selected .table-controls{ display:flex; }

/* Common sizing for toolbar controls */
.text-toolbar button,
.shape-controls button,
.table-controls button{
  height: var(--tb-item-h);
  min-width: var(--tb-item-h);
  padding: 0 10px;
  display:flex;
  align-items:center;
  justify-content:center;
  line-height:1;
  border-radius:10px;

  background: rgba(255,255,255,0.08);
  border:1px solid var(--border);
  color: var(--text);
  cursor:pointer;
  font-size:13px;
  font-weight:600;
  transition: all 0.2s;
}
.text-toolbar button:hover,
.shape-controls button:hover,
.table-controls button:hover{
  background: rgba(124,92,255,0.3);
  border-color: rgba(124,92,255,0.6);
}
.text-toolbar button.active{
  background: rgba(124,92,255,0.5);
  border-color: rgba(124,92,255,0.8);
}

/* inputs */
.text-toolbar input[type="color"],
.shape-controls input[type="color"],
.table-controls input[type="color"]{
  width: var(--tb-item-h);
  height: var(--tb-item-h);
  min-width: var(--tb-item-h);
  min-height: var(--tb-item-h);
  padding:2px;
  border-radius:10px;
  border:1px solid var(--border);
  background: rgba(255,255,255,0.08);
  cursor:pointer;
}

.text-toolbar input[type="number"]{
  height: var(--tb-item-h);
  width: 60px;
  padding:0;
  margin:0;
  text-align:center;
  line-height: var(--tb-item-h);
  border-radius:10px;
  border:1px solid var(--border);
  background: rgba(255,255,255,0.08);
  color: var(--text);
  outline:none;
}

.shape-controls input[type="range"]{
  height: var(--tb-item-h);
  width: 120px;
  accent-color: var(--accent);
}

/* labels/grouping */
.shape-controls .control-group{
  display:flex;
  align-items:center;
  gap:6px;
}
.shape-controls label{
  font-size:11px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing:.5px;
  line-height:1;
}

/* divider */
.text-toolbar .divider,
.table-controls .divider{
  width:1px;
  height: 24px;
  align-self:center;
  background: var(--border);
  margin:0 4px;
}

/* Custom dropdown (Arial) */
.custom-dropdown{
  position:relative;
  display:inline-block;
  width: 75px;
  flex-shrink:0;
}
.custom-dropdown-button{
  width:100%;
  height: var(--tb-item-h);
  padding: 0 10px;

  display:flex;
  align-items:center;
  justify-content:center;

  border:1px solid var(--border);
  border-radius:10px;
  background: rgba(255,255,255,0.06);
  color: var(--text);
  font-size:12px;
  cursor:pointer;
  outline:none;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.custom-dropdown-menu{
  position:absolute;
  top:100%;
  left:0; right:0;
  margin-top:6px;
  background: rgba(15, 27, 46, 0.95);
  border:1px solid var(--border);
  border-radius:10px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.4);
  z-index:1000;
  max-height: 250px;
  overflow:auto;
  padding:4px;
  display:flex;
  flex-direction:column;
}
.custom-dropdown-item{
  padding: 6px 10px;
  font-size: 11px;
  border-radius: 8px;
  cursor:pointer;
  color: rgba(255,255,255,.92);
}
.custom-dropdown-item:hover{
  background: rgba(124, 92, 255, 0.3);
}
.custom-dropdown-item.selected{
  background: linear-gradient(135deg, rgba(124, 92, 255, 0.95), rgba(124, 92, 255, 0.55));
  font-weight:600;
}

/* =========================
   TABLE (INSIDE SLIDE)
========================== */
.data-table{
  width:100%;
  height:100%;
  border-collapse:collapse;
  font-size:14px;
  font-family: Arial, sans-serif;
}
.data-table th,
.data-table td{
  border: 1px solid #cccccc;
  padding: 8px 12px;
  text-align:left;
  min-width:60px;
  cursor:text;
}
.data-table th{
  background:#f3f4f6;
  font-weight:600;
  color:#111827;
}
.data-table td{
  background:#ffffff;
  color:#374151;
}
.data-table th:focus,
.data-table td:focus{
  outline: 2px solid rgba(124,92,255,0.5);
  outline-offset:-2px;
}

/* =========================
   BOTTOM SLIDES BAR
========================== */
.slidesbar{
  grid-column:2;
  grid-row:3;
  border:1px solid var(--border);
  border-radius: var(--radius);
  background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
  box-shadow: var(--shadow);
  overflow:hidden;
  display:flex;
  flex-direction:column;
}

.slidesbar .header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 12px;
  border-bottom:1px solid var(--border);
  background: rgba(0,0,0,.12);
  font-size:13px;
  color:var(--muted);
}

.thumbs{
  padding:12px;
  display:flex;
  gap:12px;
  overflow:auto;
  align-items:flex-start;
}
.thumbs::-webkit-scrollbar{ display:none; }

.thumb{
  flex:0 0 auto;
  width:120px;
  border:1px solid var(--border);
  background: rgba(0,0,0,.14);
  border-radius:14px;
  padding:8px;
  cursor:pointer;
  transition: transform .08s ease, border-color .12s ease, background .12s ease;
}
.thumb:hover{ transform:translateY(-1px); }
.thumb.active{
  border-color: rgba(124,92,255,.75);
  background: rgba(124,92,255,.14);
}
.thumb .mini{
  width:100%;
  aspect-ratio: 16 / 9;
  border-radius:8px;
  background:#fff;
  position:relative;
  overflow:hidden;
}
.thumb .label{
  margin-top:8px;
  display:flex;
  justify-content:space-between;
  font-size:12px;
  color:rgba(255,255,255,.75);
}

/* =========================
   CONTEXT MENU
========================== */
.context-menu{
  position:absolute;
  z-index:10000;
  width:200px;
  background: var(--panel);
  border:1px solid var(--border);
  border-radius:8px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  display:none;
  flex-direction:column;
  padding:6px 0;
  overflow:hidden;
  backdrop-filter: blur(10px);
}
.context-menu.visible{
  display:flex;
  animation: fadeIn .1s ease-out;
}
@keyframes fadeIn{
  from{ opacity:0; transform: scale(0.95); }
  to{ opacity:1; transform: scale(1); }
}
.context-item{
  padding:8px 16px;
  font-size:13px;
  color:var(--text);
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:10px;
  transition: background .1s;
}
.context-item:hover{ background: rgba(255,255,255,0.1); }
.context-item.danger{ color:#ff5c5c; }
.context-item.danger:hover{ background: rgba(255, 92, 92, 0.15); }
.context-divider{
  height:1px;
  background: var(--border);
  margin:4px 0;
}
.context-icon{
  width:16px;
  text-align:center;
  color:var(--muted);
  font-size:12px;
}

/* =========================
   RESPONSIVE
========================== */
@media (max-width: 1100px){
  .app{ grid-template-columns: 290px 1fr; }
  .slide{ width:820px; height:461px; }
  .slide-wrap{ transform: translateX(30px); }
}
@media (max-width: 920px){
  body{ overflow:auto; }
  .app{
    height:auto;
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto auto;
  }
  .sidebar{ grid-column:1; grid-row:1; }
  .main{ grid-column:1; grid-row:2; }
  .resizer-y{ display:none; }
  .slidesbar{ grid-column:1; grid-row:3; }
  .slide-wrap{ transform:none; }
  .slide{ width:92vw; height: calc(92vw * 9/16); }
}
